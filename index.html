<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mapa de envueltos tradicionales del Ecuador — Encuesta de investigación gastronómica</title>
<style>
:root{
  --pri:#1f4e79; --pri-600:#163a5a;
  --acc:#f4c430; --bg:#f5f7fb;
  --card:#ffffff; --ink:#1c1c1c;
  --muted:#5c6b7a; --ok:#137333; --err:#b3261e;
}
body{margin:0;font-family:"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.5}
header{position:relative;overflow:hidden;border-bottom:4px solid var(--acc)}
header img{width:100%;height:260px;object-fit:cover;filter:contrast(.95) saturate(1.05)}
header .title{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.35));color:#fff;text-align:center;padding:1rem}
header h1{margin:.2rem 0;font-size:clamp(1.2rem,2.5vw,1.8rem)}
header p{opacity:.95;margin:0;font-size:clamp(.9rem,2vw,1rem)}
main{max-width:980px;margin:auto;padding:clamp(16px,3vw,28px)}
.card{background:var(--card);border:1px solid #e5e9f2;border-radius:14px;box-shadow:0 2px 8px rgba(16,24,40,.04);
  padding:clamp(16px,3vw,28px);margin:18px 0}
h2{color:var(--pri);font-size:1.2rem;margin:.2rem 0 1rem}
h3{color:var(--pri);font-size:1.05rem;margin:1rem 0 .5rem}
label{font-weight:600;display:block;margin:.7rem 0 .3rem}
.muted{color:var(--muted);font-size:.95rem}
input[type=text],input[type=number],select,textarea{
  width:100%;padding:.65rem .75rem;border:1px solid #cfd7e3;border-radius:10px;font-size:1rem;background:#fff}
textarea{min-height:84px;resize:vertical}
.grid{display:grid;gap:14px}
.g2{grid-template-columns:repeat(auto-fit,minmax(240px,1fr))}
.checklist{display:grid;gap:.4rem;margin:.4rem 0}
.otros-wrap{display:flex;gap:.5rem;align-items:center;margin-left:1.7rem}
.acciones{display:flex;gap:.6rem;flex-wrap:wrap}
button{all:unset;display:inline-block;cursor:pointer;user-select:none;background:var(--pri);color:#fff;
  padding:.75rem 1.1rem;border-radius:10px;font-weight:600;transition:.2s}
button.secondary{background:#eef2f8;color:#182335}
button:hover{background:var(--pri-600)}button.secondary:hover{background:#e5ebf4}
button:disabled{opacity:.6;cursor:not-allowed}
.msg{display:none;margin-top:.8rem;padding:.75rem .9rem;border-radius:10px;font-weight:600}
.msg.ok{display:block;background:#e6f4ea;color:var(--ok);border:1px solid #c7e7cd}
.msg.err{display:block;background:#fce8e6;color:var(--err);border:1px solid #f4b7b1}
.hidden{display:none!important}
fieldset.envuelto{border:1px solid #e2e8f5;border-left:6px solid var(--pri);border-radius:12px;padding:1rem;margin:1rem 0 1.2rem;background:#fbfdff}
fieldset.envuelto legend{font-weight:700;color:var(--pri)}
</style>
</head>
<body>

<header>
  <img src="https://uploads.vibra.co/1/2021/09/como-hacer-envueltos-de-mazorca.jpg" alt="Envueltos tradicionales de maíz">
  <div class="title"><div>
    <h1>Mapa de envueltos tradicionales del Ecuador</h1>
    <p>Encuesta de investigación gastronómica</p>
  </div></div>
</header>

<main>
  <!-- CONSENTIMIENTO -->
  <section id="consent-card" class="card">
    <h2>Política y Privacidad</h2>
    <p>La presente encuesta es un trabajo de investigación en el cual se busca conocer los distintos tipos de envueltos elaborados en cada región del país, cuyo objetivo es documentar, preservar y visibilizar la diversidad de envueltos que forman parte del patrimonio culinario ecuatoriano.</p>
    <p>Su participación en esta encuesta es completamente voluntaria y libre; por lo tanto, tiene el derecho de aceptar o no participar. Al continuar con esta encuesta, usted manifiesta su consentimiento informado para participar en este estudio comprendiendo que la información recabada será utilizada exclusivamente con fines académicos y de investigación. Todos los datos proporcionados serán tratados de manera confidencial y asegurando que no se divulgará información personal fuera del contexto de este estudio.</p>
    <div class="acciones">
      <button id="btn-acepto">✅ Sí, acepto participar</button>
      <button class="secondary" id="btn-noacepto">❌ No, gracias</button>
    </div>
    <div id="consent-msg" class="msg"></div>
  </section>

  <!-- FORMULARIO -->
  <form id="form" class="card hidden">
    <h2>SECCIÓN I: Datos Generales</h2>

    <h3>Seleccione el rango de edad al que pertenece:</h3>
    <div class="checklist">
      <label><input type="radio" name="edad" value="18–27 años (Generación Z)">18 – 27 años (Generación Z)</label>
      <label><input type="radio" name="edad" value="28–43 años (Millennials)">28 – 43 años (Millennials)</label>
      <label><input type="radio" name="edad" value="44–59 años (Generación X)">44 – 59 años (Generación X)</label>
      <label><input type="radio" name="edad" value="60–74 años (Baby Boomers)">60 – 74 años (Baby Boomers)</label>
      <label><input type="radio" name="edad" value="75 años o más (Generación Silenciosa)">75 años o más (Generación Silenciosa)</label>
    </div>

    <h3>Género</h3>
    <div class="checklist">
      <label><input type="radio" name="genero" value="Femenino">Femenino</label>
      <label><input type="radio" name="genero" value="Masculino">Masculino</label>
      <label><input type="radio" name="genero" value="Otro">Otro</label>
    </div>

    <h3>Región (opción múltiple)</h3>
    <div class="checklist">
      <label><input type="checkbox" name="region" value="Costa">Costa</label>
      <label><input type="checkbox" name="region" value="Sierra">Sierra</label>
      <label><input type="checkbox" name="region" value="Amazonia">Amazonia</label>
      <label><input type="checkbox" name="region" value="Insular">Insular</label>
    </div>

    <div class="grid g2">
      <div><label for="provincia">Provincia</label><input id="provincia" name="provincia" placeholder="Ingrese su provincia"></div>
      <div><label for="ciudad">Ciudad</label><input id="ciudad" name="ciudad" placeholder="Ingrese su ciudad"></div>
    </div>

    <h3>Actividad principal o laboral que desempeña<br><span class="muted">(Marque la opción que mejor describa su ocupación actual)</span></h3>
    <div class="checklist">
      <label><input type="checkbox" name="actividad" value="Cocinero/a tradicional">Cocinero/a tradicional</label>
      <label><input type="checkbox" name="actividad" value="Docente de gastronomía">Docente de gastronomía</label>
      <label><input type="checkbox" name="actividad" value="Promotor/a cultural o turístico">Promotor/a cultural o turístico</label>
      <label><input type="checkbox" name="actividad" value="Chef profesional">Chef profesional</label>
      <label><input type="checkbox" name="actividad" value="Emprendedor/a o propietario de un negocio gastronómico">Emprendedor/a o propietario de un negocio gastronómico</label>
    </div>

    <h3>Años de experiencia en la actividad gastronómica:</h3>
    <div class="checklist">
      <label><input type="radio" name="experiencia" value="Menos de 1 año">Menos de 1 año</label>
      <label><input type="radio" name="experiencia" value="1–3 años">1 a 3 años</label>
      <label><input type="radio" name="experiencia" value="4–6 años">4 a 6 años</label>
      <label><input type="radio" name="experiencia" value="7–10 años">7 a 10 años</label>
      <label><input type="radio" name="experiencia" value="Más de 10 años">Más de 10 años</label>
    </div>

    <h2>SECCIÓN II: Envueltos</h2>
    <p>Seleccione 1 o más envueltos que sean los más representativos e importantes de su región o provincia de origen. <br><span class="muted">(Después de esta pregunta se desplegará un cuestionario específico por cada envuelto seleccionado)</span></p>
    <div id="envueltos-list" class="checklist"></div>
    <div class="otros-wrap"><label>Otros:</label><input id="env-otros" type="text" placeholder="Especifique"></div>
    <div id="bloques"></div>

    <h2>SECCIÓN III: Estrategias</h2>
    <h3>¿Qué estrategias utiliza o ha utilizado desde su ámbito laboral o personal para conservar y transmitir los conocimientos sobre la preparación de envueltos? <br><span class="muted">(Puede seleccionar más de una opción)</span></h3>
    <div class="checklist">
      <label><input type="checkbox" name="estrategias" value="Talleres de cocina o demostraciones prácticas">Talleres de cocina o demostraciones prácticas</label>
      <label><input type="checkbox" name="estrategias" value="Transmisión en el hogar (enseñanza familiar)">Transmisión en el hogar (enseñanza familiar)</label>
      <label><input type="checkbox" name="estrategias" value="Actividades comunitarias o ferias gastronómicas">Actividades comunitarias o ferias gastronómicas</label>
      <label><input type="checkbox" name="estrategias" value="Docencia en instituciones educativas">Docencia en instituciones educativas</label>
      <label><input type="checkbox" name="estrategias" value="Publicaciones o material escrito (recetarios, artículos, etc.)">Publicaciones o material escrito (recetarios, artículos, etc.)</label>
      <label><input type="checkbox" name="estrategias" value="Uso de medios digitales (videos, redes sociales, blogs, etc.)">Uso de medios digitales (videos, redes sociales, blogs, etc.)</label>
      <label><input type="checkbox" name="estrategias" value="Otro">Otro (especifique): <input type="text" name="estrategias_otro" style="width:60%"></label>
    </div>

    <div class="acciones"><button type="submit">Enviar respuestas</button><div id="form-msg" class="msg"></div></div>
  </form>
</main>

<script>
document.addEventListener("DOMContentLoaded",()=>{
  const btnYes=document.getElementById("btn-acepto"),btnNo=document.getElementById("btn-noacepto"),
  card=document.getElementById("consent-card"),form=document.getElementById("form"),msg=document.getElementById("consent-msg");
  btnYes.onclick=()=>{card.classList.add("hidden");form.classList.remove("hidden")};
  btnNo.onclick=()=>{msg.textContent="Has decidido no participar. Gracias por tu tiempo.";msg.className="msg err"};

  const ENVUELTOS=["Humita","Chigüil","Tamal lojano","Tamales Pelileo","Tamal de mote","Tamales de zambo","Bollo de pescado","Tonga manaba","Tonga marinera","Maito de pescado","Maito de gallina","Maito de chontacuro","Pescado moqueado / ahumado","Ayampaco","Dulce/conserva de guineo","Chivil","Vincundo / Putsucutanda","Arepa de zapallo","Timbulo","Quimbolito"];
  const lista=document.getElementById("envueltos-list"),otros=document.getElementById("env-otros"),bloques=document.getElementById("bloques");
  ENVUELTOS.forEach((e,i)=>lista.insertAdjacentHTML("beforeend",`<label><input type="checkbox" value="${e}" id="env_${i}">${e}</label>`));

  function crearLista(grupo,idx,opciones){
    return `<div class="checklist">${opciones.map(o=>{
      const esOtro=o==="Otros";
      const inputExtra=esOtro?`: <input type="text" name="${grupo}_${idx}_otro" data-grupo="${grupo}_${idx}" style="width:60%">`:"";
      return `<label><input type="checkbox" name="${grupo}_${idx}" value="${o}" ${esOtro?'data-es-otro="true"':''}>${o}${inputExtra}</label>`;
    }).join('')}</div>`;
  }

  function generarBloque(nombre,idx){
    return `<fieldset class="envuelto"><legend>${nombre}</legend>
    <h3>1) ¿Qué tipo de masa/base utiliza en la preparación del envuelto?</h3>${crearLista("masa",idx,["Harina de maíz","Harina de trigo","Arroz","Yuca","Verde/plátano","Zambo","Mote","Maíz/choclo tierno","Guineo/plátano maduro","Zapallo","Otros"])}
    <h3>2) ¿Qué tipo de relleno utiliza en la preparación del envuelto?</h3>${crearLista("relleno",idx,["Carne de cerdo","Carne de res","Gallina","Pollo","Pescado","Pulpo","Calamar","Camarón","Chontacuro","Queso","Maní","Pasas","Higos en conserva","Dulce de leche","Panela","Sin relleno","Otros"])}
    <h3>3) ¿Qué tipo de hoja utiliza para preparar el envuelto?</h3>${crearLista("hoja",idx,["Hoja de achira","Hoja de bijao","Hoja de la planta de maíz","Hoja de huicundo","Hoja de plátano (fresca)","Hoja de plátano (seca)","Hoja de choclo (fresca)","Hoja de choclo (seca)","Otros"])}
    <h3>4) ¿Qué técnica de cocción se utiliza para preparar el envuelto?</h3>${crearLista("tecnica",idx,["Hervido","Al vapor","Cocción lenta","Al horno (industrial)","Al horno (manaba)","Al rescoldo / brasa","Baño maría","Bajo tierra","Otros"])}
    <h3>5) ¿Qué utensilio o herramienta utiliza para aplicar la técnica de cocción mencionada anteriormente?</h3>${crearLista("herramienta",idx,["Olla vaporera / tamalera","Olla de barro","Lata para horno","Ollas","Paila","Parrilla","Otros"])}
    <h3>6) ¿Por qué medio o con quién adquirió sus conocimientos sobre la preparación del envuelto? <span class='muted'>(Puede seleccionar más de una opción)</span></h3>${crearLista("aprendizaje",idx,["Madres/abuelas","Cursos de cocina","Institutos Gastronómicos o centros de formación técnica","Universidad con carrera en Gastronomía","Cocineros/as tradicionales","Experiencia propia en cocina (aprendizaje empírico)","Medios digitales (YouTube, redes sociales, blogs, etc.)","Libros o recetarios tradicionales","Aprendizaje en el lugar de trabajo (restaurantes, ferias, emprendimientos gastronómicos)","Otros"])}
    <h3>7) ¿En qué contexto o situaciones usted prepara tradicionalmente el envuelto?</h3>${crearLista("contexto",idx,["Festivo o cultural (celebraciones tradicionales, fiestas religiosas)","Familiar o social (matrimonios, bautizos, reuniones familiares)","Comercial (venta en ferias, mercados, restaurantes)","Consumo cotidiano o doméstico (desayuno, almuerzo, merienda)"])}</fieldset>`;
  }

  function actualizar(){
    const sel=[...lista.querySelectorAll("input:checked")].map(i=>i.value);
    if(otros.value.trim())sel.push(`Otros: ${otros.value.trim()}`);
    bloques.innerHTML=sel.map((n,i)=>generarBloque(n,i)).join('');
  }
  lista.onchange=otros.oninput=actualizar;

  const SCRIPT_URL="https://script.google.com/macros/s/AKfycbyWghgG0c0BoYyuXa7UKSk-Hhk-Wk7v2RXWUm3PzB2UjK6ZQYaDfshrNTk58gAAChi0UA/exec";
  const formMsg=document.getElementById("form-msg");

  form.addEventListener("submit", async e=>{
    e.preventDefault();
    const btn=form.querySelector("button[type=submit]");
    btn.disabled=true;
    formMsg.className="msg";
    formMsg.style.display="block";
    formMsg.textContent="⏳ Enviando respuestas, por favor espere…";
    await new Promise(r=>setTimeout(r,150));

    const fd=new FormData(form);
    const data={};
    fd.forEach((value,key)=>{
      if(data[key]) data[key]+=", "+value;
      else data[key]=value;
    });

    const envueltosSeleccionados=[];
    lista.querySelectorAll('input[type=checkbox]:checked').forEach(chk=>envueltosSeleccionados.push(chk.value));
    if(otros.value.trim()) envueltosSeleccionados.push("Otros: "+otros.value.trim());
    data["EnvueltosSeleccionados"]=envueltosSeleccionados.join(", ");

    const otrosInputs=document.querySelectorAll('input[type=text][name*="_otro"]');
    otrosInputs.forEach(input=>{
      if(input.value.trim()!==""){
        const key=input.dataset.grupo;
        const checkbox=document.querySelector(`input[data-es-otro="true"][name="${key}"]`);
        if(checkbox&&checkbox.checked){
          if(!data[key]) data[key]="";
          data[key]+=(data[key]?", ":"")+"Otros: "+input.value.trim();
        }
      }
    });

    try{
      await fetch(SCRIPT_URL,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)});
      formMsg.className="msg ok";
      formMsg.textContent="✅ Respuestas enviadas correctamente. ¡Gracias por participar!";
      form.reset();
      bloques.innerHTML="";
    }catch(err){
      formMsg.className="msg err";
      formMsg.textContent="❌ Error al conectar con el servidor. Intenta nuevamente.";
    }
    setTimeout(()=>{btn.disabled=false;},2000);
  });
});
</script>

</body>
</html>

